(self.webpackChunkestafette_ci_web=self.webpackChunkestafette_ci_web||[]).push([[17],{3175:function(e,t,i){"use strict";i.d(t,{Z:function(){return w}});var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("router-link",{staticClass:"row-block list-complete-item",attrs:{to:{name:"PipelineBuildLogs",params:{repoSource:e.build.repoSource,repoOwner:e.build.repoOwner,repoName:e.build.repoName,id:e.build.id}},tag:"div"}},[e.allBuildsMode?i("property-block",{staticClass:"col-xxxl-3",attrs:{label:"Pipeline"}},[i("repository-title",{attrs:{repo:e.build}})],1):e._e(),e._v(" "),i("property-block",{staticClass:"col-xxxl-2",attrs:{label:"Version",value:e.build.buildVersion}}),e._v(" "),i("property-block",{staticClass:"col-xxxl-1",attrs:{label:"Status",value:e.build.buildStatus}},[i("b-progress",[i("b-progress-bar",{attrs:{value:e.$options.filters.buildProgressBarValue(e.pipeline,e.build,e.now),label:e.$options.filters.buildProgressBarLabel(e.pipeline,e.build,e.now),variant:e.$options.filters.bootstrapVariant(e.build.buildStatus),animated:e.$options.filters.animatedProgressBar(e.build.buildStatus)}})],1)],1),e._v(" "),i("property-block",{staticClass:"col-xxxl-2",attrs:{label:"Built at",value:e._f("formatDatetime")(e.build.insertedAt)}},[e._v("\n    "+e._s(e._f("formatDatetime")(e.build.insertedAt))+"\n    "),i("duration-label",{attrs:{duration:e.build.duration,"pending-duration":e.build.pendingDuration}})],1),e._v(" "),i("property-block",{staticClass:"col-xxxl-1",attrs:{label:"Branch",value:e.build.repoBranch}}),e._v(" "),i("property-block",{staticClass:"col-xxxl-1",attrs:{label:"Revision"}},[i("commit-link",{attrs:{build:e.build}})],1),e._v(" "),i("property-block",{class:e.allBuildsMode?"col-xxxl-2":"col-xxxl-3",attrs:{label:"Commit(s)"}},[i("commits",{attrs:{commits:e.build.commits}})],1),e._v(" "),e.showActions?i("property-block",{staticClass:"col-xxxl-2",attrs:{label:"Actions","no-truncate":""}},[i("release-button",{attrs:{pipeline:e.pipeline,build:e.build}}),e._v(" "),i("rebuild-button",{attrs:{build:e.build,builds:e.builds}}),e._v(" "),i("cancel-button",{attrs:{build:e.build}})],1):e._e(),e._v(" "),e.showReleases?i("div",{staticClass:"block-divider"},[i("div")]):e._e(),e._v(" "),e.showReleases?i("property-block",{attrs:{label:"Releases",wide:""}},e._l(e.pipeline.releaseTargets,(function(t){return i("release-badge-for-build",{key:t.name,attrs:{"release-target":t,build:e.build}})})),1):e._e()],1)};n._withStripped=!0;var r=i(629),s=i(5752),l=i(2981),a=i(1006),o=i(2776),u=i(5654),c=i(8418),p=i(377),d=i(5322),b=i(6342),f=i(8714),h=i(7322),m=i(3900);function v(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var g={components:{BProgress:s.D,BProgressBar:l.Q,CommitLink:a.Z,ReleaseButton:o.Z,RebuildButton:u.Z,CancelButton:c.Z,ReleaseBadgeForBuild:p.Z,PropertyBlock:d.Z,DurationLabel:b.Z,RepositoryTitle:f.Z,Commits:h.Z},props:{build:{type:Object,default:null},builds:{type:Array,default:null},pipeline:{type:Object,default:null},allBuildsMode:{type:Boolean,default:!1}},data:function(){return{now:Date.now()}},created:function(){this.updateNow()},methods:{updateNow:function(){this.now=Date.now(),!this.build||"pending"!==this.build.buildStatus&&"running"!==this.build.buildStatus||m.Z.timeout(this.timeout,this.updateNow,1)}},beforeDestroy:function(){clearTimeout(this.timeout)},computed:function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){v(e,t,i[t])}))}return e}({},(0,r.rn)("user",{user:"me"}),{showReleases:function(){var e=this;return!!(this.pipeline&&this.pipeline.releaseTargets&&this.pipeline.releaseTargets.length>0)&&this.pipeline.releaseTargets.some((function(t){return t.activeReleases&&t.activeReleases.some((function(t){return t.releaseVersion===e.build.buildVersion}))}))},showActions:function(){return!this.allBuildsMode&&this.user&&this.user.active&&this.build&&("failed"===this.build.buildStatus||"pending"===this.build.buildStatus||"running"===this.build.buildStatus||"canceled"===this.build.buildStatus||"canceling"===this.build.buildStatus||this.pipeline&&this.pipeline.releaseTargets&&this.pipeline.releaseTargets.length>0&&"succeeded"===this.build.buildStatus)}})},_=(0,i(1900).Z)(g,n,[],!1,null,null,null);_.options.__file="src/components/BuildRow.vue";var w=_.exports},1006:function(e,t,i){"use strict";i.d(t,{Z:function(){return l}});var n=function(){var e=this,t=e.$createElement;return(e._self._c||t)("a",{class:["text-body"],attrs:{href:e.commitURL(),target:"_blank",title:e._f("gitHash")(e.build.repoRevision)},on:{click:function(e){e.stopPropagation()}}},[e._v("\n  "+e._s(e._f("gitHash")(e.build.repoRevision))+"\n")])};n._withStripped=!0;var r={props:{build:{type:Object,default:null}},methods:{commitURL:function(){switch(this.build.repoSource){case"github.com":return"https://github.com/".concat(this.build.repoOwner,"/").concat(this.build.repoName,"/commit/").concat(this.build.repoRevision);case"bitbucket.org":return"https://bitbucket.org/".concat(this.build.repoOwner,"/").concat(this.build.repoName,"/commits/").concat(this.build.repoRevision)}return"#"}}},s=(0,i(1900).Z)(r,n,[],!1,null,null,null);s.options.__file="src/components/CommitLink.vue";var l=s.exports},7322:function(e,t,i){"use strict";i.d(t,{Z:function(){return l}});var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",e._l(e.limitCommits,(function(t){return i("div",{key:t.message,staticClass:"text-truncate",attrs:{title:t.message+" / "+t.author.name}},[e._v("\n    "+e._s(t.message)+" / "+e._s(t.author.name)+"\n  ")])})),0)};n._withStripped=!0;var r={props:{commits:{type:Array,default:null},limit:{type:Number,default:3}},computed:{limitCommits:function(){return this.commits?this.commits.length<=this.limit?this.commits:this.commits.slice(0,this.limit):[]}}},s=(0,i(1900).Z)(r,n,[],!1,null,null,null);s.options.__file="src/components/Commits.vue";var l=s.exports},6388:function(e,t,i){"use strict";i.d(t,{Z:function(){return b}});var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.filteredLabels.length>1?i("b-input-group",{staticClass:"mb-3 d-inline-flex"},[i("b-input-group-prepend",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],attrs:{"is-text":"",title:"Filter pipelines on frequently used labels"}},[i("font-awesome-icon",{attrs:{icon:"tags"}})],1),e._v(" "),i("b-form-select",{staticClass:"d-inline-flex",attrs:{options:e.filteredLabels},on:{change:e.onChange},model:{value:e.mutableModel,callback:function(t){e.mutableModel=t},expression:"mutableModel"}})],1):e._e()};n._withStripped=!0;var r=i(6127),s=i(7754),l=i(6982),a=i(648),o=i(8947),u=i(1436),c=i(7810);o.vI.add(u.tho);var p={components:{BInputGroup:r.w,BInputGroupPrepend:s.P,BFormSelect:l.K,FontAwesomeIcon:c.GN},props:{filter:{type:Object,default:null}},mixins:[a.Z],data:function(){return{labels:[],pagination:{page:1,size:15},refresh:!0,mutableModel:null}},created:function(){this.loadFrequentLabels()},methods:{loadFrequentLabels:function(){var e=this,t="";this.filter&&this.filter.labels&&this.filter.labels.length>0&&(t=this.filter.labels.split(",").join("&filter[labels]="));var i="filter[status]=".concat(this.filter.status);"running"===this.filter.status&&(i+="&filter[status]=pending&filter[status]=canceling"),this.axios.get("/api/labels/frequent?".concat(i,"&filter[since]=").concat(this.filter.since,"&filter[search]=").concat(this.filter.search,"&filter[labels]=").concat(t,"&page[number]=").concat(this.pagination.page,"&page[size]=").concat(this.pagination.size)).then((function(t){e.labels=t.data.items,e.periodicallyRefreshFrequentLabels(5)})).catch((function(t){e.periodicallyRefreshFrequentLabels(30)}))},periodicallyRefreshFrequentLabels:function(e){this.refreshTimeout&&clearTimeout(this.refreshTimeout);var t=1e3*e*.75,i=1e3*e*1.25,n=Math.floor(Math.random()*(t-i+1)+i);this.refresh&&(this.refreshTimeout=setTimeout(this.loadFrequentLabels,n))},labelLinkGenerator:function(e){return this.filter&&this.filter.labels&&0!==this.filter.labels.length?this.filter.labels+","+e:e},onChange:function(e){this.$router.push({query:this.queryGenerator({labels:this.labelLinkGenerator(e),page:1})}),this.mutableModel=null}},computed:{filteredLabels:function(){if(!this.labels)return[];var e=[];return this.filter&&this.filter.labels&&(e=this.filter.labels.split(",")),[{value:null,text:"Frequent labels"}].concat(this.labels.filter((function(t){return-1===e.indexOf("".concat(t.key,"=").concat(t.value))})).map((function(e){return{value:"".concat(e.key,"=").concat(e.value),text:"".concat(e.key,"=").concat(e.value," (").concat(e.pipelinescount,")")}})))}},watch:{filter:{handler:function(e,t){this.loadFrequentLabels()},deep:!0}},beforeDestroy:function(){this.refresh=!1,this.refreshTimeout&&clearTimeout(this.refreshTimeout)}},d=(0,i(1900).Z)(p,n,[],!1,null,null,null);d.options.__file="src/components/FrequentLabels.vue";var b=d.exports},7651:function(e,t,i){"use strict";i.d(t,{Z:function(){return b}});var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.splitLabels.length>0?i("b-button-group",{staticClass:"mb-3 mr-2 bg-white"},[i("b-input-group-prepend",{attrs:{"is-text":""}},[i("font-awesome-icon",{attrs:{icon:"tag"}})],1),e._v(" "),e._l(e.splitLabels,(function(t){return i("b-button",{key:t,staticClass:"border-btn-group bg-white text-nowrap",attrs:{variant:"outline-primary"}},[e._v("\n    "+e._s(t)+" "),i("router-link",{staticClass:"badge badge-primary",attrs:{to:{query:e.queryGenerator({labels:e.labelLinkGenerator(t)})},"active-class":"router-link-active"}},[e._v("\n      Ã—\n    ")])],1)}))],2):e._e()};n._withStripped=!0;var r=i(5969),s=i(5193),l=i(7754),a=i(648),o=i(8947),u=i(1436),c=i(7810);o.vI.add(u.LEN);var p={components:{BButtonGroup:r.a,BButton:s.T,BInputGroupPrepend:l.P,FontAwesomeIcon:c.GN},mixins:[a.Z],props:{filter:{type:Object,default:null}},methods:{labelLinkGenerator:function(e){if(!this.filter||!this.filter.labels||0===this.filter.labels.length)return"";var t=[];return this.filter&&this.filter.labels&&(t=this.filter.labels.split(",")),t.filter((function(t){return t!==e})).join(",")}},computed:{splitLabels:function(){return this.filter.labels&&0!==this.filter.labels.length?this.filter.labels.split(","):[]}}},d=(0,i(1900).Z)(p,n,[],!1,null,null,null);d.options.__file="src/components/LabelFilter.vue";var b=d.exports},5654:function(e,t,i){"use strict";i.d(t,{Z:function(){return f}});var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.allowedToRebuild()?i("b-input-group",{staticStyle:{width:"auto"}},[i("b-input-group-text",{staticClass:"border border-warning text-warning bg-white",attrs:{slot:"prepend"},on:{click:function(e){e.stopPropagation()}},slot:"prepend"},[i("font-awesome-icon",{attrs:{icon:"redo"}})],1),e._v(" "),i("b-button",{attrs:{variant:"outline-warning",size:"sm"},on:{click:function(t){return t.stopPropagation(),e.rebuild(t)}}},[e._v("\n    Rebuild\n  ")])],1):e._e()};n._withStripped=!0;var r=i(629),s=i(6127),l=i(5193),a=i(8222),o=i(8947),u=i(1436),c=i(7810);function p(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}o.vI.add(u.XSV);var d={components:{BInputGroup:s.w,BButton:l.T,BInputGroupText:a.e,FontAwesomeIcon:c.GN},props:{build:{type:Object,default:null},builds:{type:Array,default:null}},data:function(){return{clicked:!1}},methods:{allowedToRebuild:function(){var e=this;return!(!this.user.active||!this.build||"failed"!==this.build.buildStatus&&"canceled"!==this.build.buildStatus)&&(!(this.builds&&this.builds.length>0)||!this.builds.some((function(t){return t.buildVersion===e.build.buildVersion&&"succeeded"===t.buildStatus})))},rebuild:function(e){var t=this;this.user.active&&this.axios.post("/api/pipelines/".concat(this.build.repoSource,"/").concat(this.build.repoOwner,"/").concat(this.build.repoName,"/builds"),this.build).then((function(e){t.builds.unshift(e.data),t.builds.shift()})).catch((function(e){console.warn(e)}))}},computed:function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){p(e,t,i[t])}))}return e}({},(0,r.rn)("user",{user:"me"}))},b=(0,i(1900).Z)(d,n,[],!1,null,null,null);b.options.__file="src/components/RebuildButton.vue";var f=b.exports},377:function(e,t,i){"use strict";i.d(t,{Z:function(){return l}});var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.matchingReleases.length>0?i("div",{class:["btn-light","btn btn-sm mr-1"]},[e._v("\n  "+e._s(e.releaseTarget.name)),e._l(e.matchingReleases,(function(t){return i("router-link",{key:t.id,staticClass:"badge ml-1 mb-1 d-block d-md-inline-block",class:e._f("bootstrapClass")(t.releaseStatus,"badge"),attrs:{to:{name:"PipelineReleaseLogs",params:{repoSource:t.repoSource,repoOwner:t.repoOwner,repoName:t.repoName,releaseID:t.id}},exact:"",tag:"span",title:t.action}},[t.action?i("span",[e._v("\n      "+e._s(t.action)+":\n    ")]):e._e(),e._v(e._s(t.releaseStatus)+"\n  ")])}))],2):e._e()};n._withStripped=!0;var r={props:{releaseTarget:{type:Object,default:null},build:{type:Object,default:null}},computed:{matchingReleases:function(){var e=this;return this.build&&this.build.buildStatus&&"succeeded"===this.build.buildStatus&&this.releaseTarget&&this.releaseTarget.activeReleases?this.releaseTarget.activeReleases.filter((function(t){return t.releaseVersion===e.build.buildVersion})):[]}}},s=(0,i(1900).Z)(r,n,[],!1,null,null,null);s.options.__file="src/components/ReleaseBadgeForBuild.vue";var l=s.exports},2776:function(e,t,i){"use strict";i.d(t,{Z:function(){return m}});var n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return e.user&&e.user.active&&e.pipeline.releaseTargets&&e.pipeline.releaseTargets.length>0&&"succeeded"===e.build.buildStatus?i("b-input-group",{staticStyle:{width:"auto"}},[i("b-input-group-text",{staticClass:"border border-secondary text-secondary bg-white",attrs:{slot:"prepend"},on:{click:function(e){e.stopPropagation()}},slot:"prepend"},[i("font-awesome-icon",{attrs:{icon:"upload"}})],1),e._v(" "),i("b-dropdown",{attrs:{size:"sm",id:"releaseAction",text:"Release to...",variant:"outline-secondary"}},e._l(e.pipeline.releaseTargets,(function(t){return i("div",{key:t.name},[e.hasActions(t)?i("div",{attrs:{role:"group","aria-labelledby":t.name}},[i("b-dropdown-header",{attrs:{id:t.name}},[e._v("\n          "+e._s(t.name)+":\n        ")]),e._v(" "),e._l(t.actions,(function(n){return i("b-dropdown-item-button",{key:t.name+"-"+n.name,attrs:{disabled:e.releaseTargetDisabled(t),"aria-describedby":t.name},on:{click:function(i){return i.stopPropagation(),e.startRelease(t,n,i)}}},[e._v("\n          - "+e._s(n.name)+"\n        ")])}))],2):e._e(),e._v(" "),e.hasActions(t)?e._e():i("b-dropdown-item-button",{key:t.name,attrs:{disabled:e.releaseTargetDisabled(t)},on:{click:function(i){return i.stopPropagation(),e.startRelease(t,null,i)}}},[e._v("\n        "+e._s(t.name)+"\n      ")])],1)})),0)],1):e._e()};n._withStripped=!0;var r=i(629),s=i(5835),l=i(3630),a=i(2332),o=i(6127),u=i(8222),c=i(8947),p=i(1436),d=i(7810);function b(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}c.vI.add(p.cf$);var f={components:{BDropdown:s.R,BDropdownHeader:l.X,BDropdownItemButton:a.t,BInputGroup:o.w,BInputGroupText:u.e,FontAwesomeIcon:d.GN},props:{pipeline:{type:Object,default:null},build:{type:Object,default:null}},data:function(){return{clicked:!1}},methods:{releaseTargetDisabled:function(e){return this.pipeline&&this.pipeline.releaseTargets&&this.pipeline.releaseTargets.length>0&&this.pipeline.releaseTargets.some((function(t){return t.name===e.name&&t.activeReleases&&t.activeReleases.some((function(e){return e&&"running"===e.releaseStatus}))}))},startRelease:function(e,t,i){var n=this;if(this.user.active){var r={name:e.name,action:t?t.name:"",repoSource:this.build.repoSource,repoOwner:this.build.repoOwner,repoName:this.build.repoName,releaseVersion:this.build.buildVersion,releaseStatus:"pending"};this.updateRelease(r),this.axios.post("/api/pipelines/".concat(this.build.repoSource,"/").concat(this.build.repoOwner,"/").concat(this.build.repoName,"/releases"),r).then((function(e){r=e.data,n.updateRelease(r)})).catch((function(e){console.warn(e)}))}},updateRelease:function(e){var t=this.pipeline.releaseTargets.find((function(t){return t.name===e.name}));if(t)if(t.activeReleases){var i=!1,n=t.activeReleases.map((function(t){return t.action?e.action&&t.action===e.action?(i=!0,e):t:(i=!0,e)}));i||n.push(e),t.activeReleases=n}else t.activeReleases=[e]},hasActions:function(e){return e&&e.actions&&e.actions.length>0}},computed:function(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{},n=Object.keys(i);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter((function(e){return Object.getOwnPropertyDescriptor(i,e).enumerable})))),n.forEach((function(t){b(e,t,i[t])}))}return e}({},(0,r.rn)("user",{user:"me"}))},h=(0,i(1900).Z)(f,n,[],!1,null,"a329acce",null);h.options.__file="src/components/ReleaseButton.vue";var m=h.exports}}]);